"use strict";(self.webpackChunkdatalayer_docs=self.webpackChunkdatalayer_docs||[]).push([[3290],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,g=d["".concat(l,".").concat(m)]||d[m]||p[m]||o;return n?i.createElement(g,s(s({ref:t},u),{},{components:n})):i.createElement(g,s({ref:t},u))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=m;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r[d]="string"==typeof e?e:a,s[1]=r;for(var c=2;c<o;c++)s[c]=n[c];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1694:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>c});var i=n(7462),a=(n(7294),n(3905));const o={id:"hello-world",title:"Speed Run DL",sidebar_position:1},s=void 0,r={unversionedId:"Build/hello-world",id:"Build/hello-world",title:"Speed Run DL",description:"In this speed run tutorial, we'll be writing a contract to send/receive messages between chains. This is a code along tutorial, you can copy the code snippets into Remix or the dev environment of your choice. In case you are stuck, you can take peak at the entire code on GitHub. We'll be highlighting key functions and what they do throughout the tutorial. Some configuration variables have been hardcoded in the example.",source:"@site/docs/Build/hello-world.md",sourceDirName:"Build",slug:"/Build/hello-world",permalink:"/Build/hello-world",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"hello-world",title:"Speed Run DL",sidebar_position:1},sidebar:"defaultSidebar",previous:{title:"What is SocketDL?",permalink:"/introduction"},next:{title:"Configuring Plugs",permalink:"/Build/contract-setup/configuring-plugs"}},l={},c=[{value:"Step 1 : Boilerplate code",id:"step-1--boilerplate-code",level:3},{value:"Step 2 : Initialise state variables, events, modifiers",id:"step-2--initialise-state-variables-events-modifiers",level:3},{value:"State variables",id:"state-variables",level:4},{value:"Events",id:"events",level:4},{value:"Step 3 : Config Functions",id:"step-3--config-functions",level:3},{value:"Step 4 : Sending messages",id:"step-4--sending-messages",level:3},{value:"Step 5 : Receiving Messages",id:"step-5--receiving-messages",level:3},{value:"Step 6 : Deploying contracts",id:"step-6--deploying-contracts",level:3},{value:"Goerli",id:"goerli",level:4},{value:"Mumbai",id:"mumbai",level:4},{value:"Step 7 : Configuration",id:"step-7--configuration",level:3},{value:"Step 8 : Hello World",id:"step-8--hello-world",level:3}],u={toc:c},d="wrapper";function p(e){let{components:t,...n}=e;return(0,a.kt)(d,(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In this speed run tutorial, we'll be writing a contract to send/receive messages between chains. This is a code along tutorial, you can copy the code snippets into Remix or the dev environment of your choice. In case you are stuck, you can take peak at the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/SocketDotTech/socketDL-examples/blob/main/src/SpeedRunDL/SocketSpeedRunGoerli.sol"},"entire code on GitHub"),". We'll be highlighting key functions and what they do throughout the tutorial. Some configuration variables have been hardcoded in the example."),(0,a.kt)("p",null,'We\'ll be deploying the same copy of the contract on Goerli and Mumbai testnet and sending the message "Hello World" from Goerli to Mumbai. You can also deploy it on any ',(0,a.kt)("a",{parentName:"p",href:"/dev-resources/deployment-addresses"},"supported networks"),". Let's get started!"),(0,a.kt)("h3",{id:"step-1--boilerplate-code"},"Step 1 : Boilerplate code"),(0,a.kt)("p",null,"Below is the boilerplate code needed to get started. ",(0,a.kt)("inlineCode",{parentName:"p"},"ISocket")," is the interface used by our contract to interact with Socket. "),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Hello World")," is the contract which we'll be writing to send/receive messages."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"// SPDX-License-Identifier: GPL-3.0\npragma solidity ^0.8.0;\n\ninterface ISocket {\n    function outbound(\n        uint32 remoteChainSlug_,\n        uint256 minMsgGasLimit_,\n        bytes32 executionParams_,\n        bytes32 transmissionParams_,\n        bytes calldata payload_\n    ) external payable returns (bytes32 msgId);\n\n    function connect(\n        uint32 siblingChainSlug_,\n        address siblingPlug_,\n        address inboundSwitchboard_,\n        address outboundSwitchboard_\n    ) external;\n\n    function getMinFees(\n        uint256 minMsgGasLimit_,\n        uint256 payloadSize_,\n        bytes32 executionParams_,\n        bytes32 transmissionParams_,\n        uint32 remoteChainSlug_,\n        address plug_\n    ) external view returns (uint256 totalFees);\n}\n\ncontract HelloWorld {\n\n}\n")),(0,a.kt)("h3",{id:"step-2--initialise-state-variables-events-modifiers"},"Step 2 : Initialise state variables, events, modifiers"),(0,a.kt)("h4",{id:"state-variables"},"State variables"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"message")," is the message which will be set on the remote plug"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"destGasLimit")," is the gas limit of setting the message on the destination chain, this value varies depending on the chain."),(0,a.kt)("p",null,"You can learn more about the other variables in ",(0,a.kt)("a",{parentName:"p",href:"/Build/contract-setup/configuring-plugs"},"Configuring Plugs")),(0,a.kt)("h4",{id:"events"},"Events"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"MessageSent")," is emitted when a message is sent from the source plug and ",(0,a.kt)("inlineCode",{parentName:"p"},"MessageReceived")," is emitted when the message is received on the destination plug."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'    string public message = "Hello World";\n    address owner;\n\n    /**\n     * @dev Hardcoded values for Goerli\n     */\n    uint256 destGasLimit = 100000; // Gas cost of sending "Hello World" on Mumbai\n    uint32 public remoteChainSlug = 80001; // Mumbai testnet chain ID\n    address public socket = 0xe37D028a77B4e6fCb05FC75EBa845752cD62A0AA; // Socket Address on Goerli\n    address public inboundSwitchboard =\n        0xd59d596B7C7cB4593F61bbE4A82C1E943C64558D; // FAST Switchboard on Goerli\n    address public outboundSwitchboard =\n        0xd59d596B7C7cB4593F61bbE4A82C1E943C64558D; // FAST Switchboard on Goerli\n\n    event MessageSent(uint32 destChainSlug, string message);\n\n    event MessageReceived(uint32 srcChainSlug, string message);\n\n    modifier isOwner() {\n        require(msg.sender == owner, "Not owner");\n        _;\n    }\n\n    modifier isSocket() {\n        require(msg.sender == socket, "Not Socket");\n        _;\n    }\n\n    error InsufficientFees();\n\n    constructor() {\n        owner = msg.sender;\n    }\n')),(0,a.kt)("h3",{id:"step-3--config-functions"},"Step 3 : Config Functions"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"connectPlug")," function connects our Hello World ",(0,a.kt)("a",{parentName:"p",href:"/Learn/glossary"},"Plug")," to its sibling Plug on another chain. This connection is required for the Plugs to send/receive messages from one another."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"\n    function connectPlug(address siblingPlug_) external isOwner {\n        ISocket(socket).connect(\n            remoteChainSlug,\n            siblingPlug_,\n            inboundSwitchboard,\n            outboundSwitchboard\n        );\n    }\n\n")),(0,a.kt)("h3",{id:"step-4--sending-messages"},"Step 4 : Sending messages"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"sendMessage"),' sends the "Hello World" message to the remote chain. This function calls Socket and initiates the ',(0,a.kt)("inlineCode",{parentName:"p"},"outbound")," cross-chain message"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"_getMinimumFees")," fetches the fees for including messages in ",(0,a.kt)("a",{parentName:"p",href:"/Learn/Components/Packet"},"Packets")," & executing them. This can be used to verify sufficient fees are passed when sending the message. You can learn more about this in ",(0,a.kt)("a",{parentName:"p",href:"/Learn/Concepts/fees"},"Fees"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"    function sendMessage() external payable {\n        bytes memory payload = abi.encode(message);\n\n        uint256 totalFees = _getMinimumFees(destGasLimit, payload.length);\n\n        if (msg.value < totalFees) revert InsufficientFees();\n\n        ISocket(socket).outbound{value: msg.value}(\n            remoteChainSlug,\n            destGasLimit,\n            bytes32(0),\n            bytes32(0),\n            payload\n        );\n\n        emit MessageSent(remoteChainSlug, message);\n    }\n\n    function _getMinimumFees(\n        uint256 minMsgGasLimit_,\n        uint256 payloadSize_\n    ) internal view returns (uint256) {\n        return\n            ISocket(socket).getMinFees(\n                minMsgGasLimit_,\n                payloadSize_,\n                bytes32(0),\n                bytes32(0),\n                remoteChainSlug,\n                address(this)\n            );\n    }\n")),(0,a.kt)("h3",{id:"step-5--receiving-messages"},"Step 5 : Receiving Messages"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"inbound")," is called by Socket on the destination Plug for executing the message once it's verified. More in this in ",(0,a.kt)("a",{parentName:"p",href:"/Learn/lifecycle"},"Lifecycle")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"_receiveMessage")," sets the value of the new message and emits the ",(0,a.kt)("inlineCode",{parentName:"p"},"MessageReceived")," event"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"    function _receiveMessage(\n        uint32 _srcChainSlug,\n        string memory _message\n    ) internal {\n        message = _message;\n        emit MessageReceived(_srcChainSlug, _message);\n    }\n\n    function inbound(\n        uint32 srcChainSlug_,\n        bytes calldata payload_\n    ) external isSocket {\n        string memory _message = abi.decode(payload_, (string));\n        _receiveMessage(srcChainSlug_, _message);\n    }\n")),(0,a.kt)("h3",{id:"step-6--deploying-contracts"},"Step 6 : Deploying contracts"),(0,a.kt)("p",null,"We'll be deploying the same contract on Goerli and Mumbai testnets. However, to make it easier to send our first message, we've hardcoded some configuration variables specific to Goerli and Mumbai. Click the links below to deploy each of them"),(0,a.kt)("h4",{id:"goerli"},"Goerli"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://remix.ethereum.org/#url=https://github.com/SocketDotTech/socketDL-examples/blob/main/src/SpeedRunDL/SocketSpeedRunGoerli.sol"},"\ud83d\ude80 Deploy Goerli contract on Remix")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/SocketDotTech/socketDL-examples/blob/main/src/SpeedRunDL/SocketSpeedRunGoerli.sol"},"\ud83d\udcc4 Goerli contract on GitHub")),(0,a.kt)("h4",{id:"mumbai"},"Mumbai"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://remix.ethereum.org/#url=https://github.com/SocketDotTech/socketDL-examples/blob/main/src/SpeedRunDL/SocketSpeedRunMumbai.sol"},"\ud83d\ude80 Deploy Mumbai contract on Remix")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/SocketDotTech/socketDL-examples/blob/main/src/SpeedRunDL/SocketSpeedRunMumbai.sol"},"\ud83d\udcc4 Mumbai contract on GitHub")),(0,a.kt)("p",null,"You can head over to Remix and compile the code for ",(0,a.kt)("inlineCode",{parentName:"p"},"SpeedRunGoerli")),(0,a.kt)("img",{src:"/img/compiler-hello-world.png",width:"500px"}),(0,a.kt)("p",null,"Then, deploy it"),(0,a.kt)("img",{src:"/img/deploy-hello-world.png",width:"500px"}),(0,a.kt)("br",null),(0,a.kt)("br",null),(0,a.kt)("p",null,"You'll then have to deploy the ",(0,a.kt)("inlineCode",{parentName:"p"},"SpeedRunMumbai")," contract following the same steps."),(0,a.kt)("h3",{id:"step-7--configuration"},"Step 7 : Configuration"),(0,a.kt)("p",null,"Once you've deployed the contracts on Goerli and Mumbai, call the ",(0,a.kt)("inlineCode",{parentName:"p"},"connectPlug")," function with the address of the contract deployed on the other chain. You need to do this on both contracts deployed on respective chains."),(0,a.kt)("img",{src:"/img/connectPlug-hello-world.png",width:"500px"}),(0,a.kt)("br",null),(0,a.kt)("br",null),(0,a.kt)("p",null,"For instance, on Goerli you would call ",(0,a.kt)("inlineCode",{parentName:"p"},"connectPlug")," with the address of the contract deployed on Mumbai and vice-versa. This establishes a connection between the two Plugs deployed and you can now send messages between them!"),(0,a.kt)("h3",{id:"step-8--hello-world"},"Step 8 : Hello World"),(0,a.kt)("p",null,"To send your first message, call the ",(0,a.kt)("inlineCode",{parentName:"p"},"sendMessage")," function on Goerli. You need to send a fee in ETH as ",(0,a.kt)("inlineCode",{parentName:"p"},"value")," when calling ",(0,a.kt)("inlineCode",{parentName:"p"},"sendMessage"),". This fee can be calculated using the ",(0,a.kt)("a",{parentName:"p",href:"/dev-resources/APIReference/estimate-fees"},"Fee Estimate API")," "),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://surge.dlapi.socket.tech/estimate-fees?srcChainSlug=5&dstChainSlug=80001&integrationType=FAST&msgGasLimit=100000"},"https://surge.dlapi.socket.tech/estimate-fees?srcChainSlug=5&dstChainSlug=80001&integrationType=FAST&msgGasLimit=100000")),(0,a.kt)("p",null,"You can enter the ",(0,a.kt)("inlineCode",{parentName:"p"},"totalFee")," returned by this API as ",(0,a.kt)("inlineCode",{parentName:"p"},"value")," when sending the transaction"),(0,a.kt)("img",{src:"/img/sendMessage-hello-world.png",width:"400px"}),(0,a.kt)("br",null),(0,a.kt)("br",null),(0,a.kt)("p",null,"That's it! You can now track the status of your message using the ",(0,a.kt)("a",{parentName:"p",href:"/dev-resources/APIReference/track-status"},"Status Tracking API"),". Once your message is executed on Mumbai, you'll be able to see the ",(0,a.kt)("inlineCode",{parentName:"p"},"message"),' value set to "Hello World" on Mumbai.'),(0,a.kt)("img",{src:"/img/success-hello-world.png",width:"400px"}),(0,a.kt)("br",null),(0,a.kt)("br",null),(0,a.kt)("admonition",{title:"You're Plugged!",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"You've successfully sent your first message via SocketDL. Explore more in ",(0,a.kt)("a",{parentName:"p",href:"/dev-resources/TutorialSection/example-counter"},"Tutorials")," and ",(0,a.kt)("a",{parentName:"p",href:"/Build/ExampleSection/dl-examples"},"Examples"),".")))}p.isMDXComponent=!0}}]);