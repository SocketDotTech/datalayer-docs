"use strict";(self.webpackChunkdatalayer_docs=self.webpackChunkdatalayer_docs||[]).push([[7153],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),l=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=l(e.components);return i.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},g=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),d=l(n),g=o,f=d["".concat(s,".").concat(g)]||d[g]||p[g]||r;return n?i.createElement(f,a(a({ref:t},u),{},{components:n})):i.createElement(f,a({ref:t},u))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=g;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[d]="string"==typeof e?e:o,a[1]=c;for(var l=2;l<r;l++)a[l]=n[l];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}g.displayName="MDXCreateElement"},2089:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>c,toc:()=>l});var i=n(7462),o=(n(7294),n(3905));const r={id:"testing-dl",title:"Testing integration",sidebar_position:3},a=void 0,c={unversionedId:"Build/testing-dl",id:"Build/testing-dl",title:"Testing integration",description:"- Testing DL",source:"@site/docs/Build/testing-DL.md",sourceDirName:"Build",slug:"/Build/testing-dl",permalink:"/Build/testing-dl",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"testing-dl",title:"Testing integration",sidebar_position:3},sidebar:"defaultSidebar",previous:{title:"Receiving messages",permalink:"/Build/contract-setup/receiving"},next:{title:"Examples",permalink:"/category/examples"}},s={},l=[{value:"MockSocket",id:"mocksocket",level:3},{value:"Testing integration locally",id:"testing-integration-locally",level:3},{value:"Testing Plug connection",id:"testing-plug-connection",level:3},{value:"API",id:"api",level:4},{value:"On-chain",id:"on-chain",level:4}],u={toc:l},d="wrapper";function p(e){let{components:t,...n}=e;return(0,o.kt)(d,(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Testing DL "),(0,o.kt)("li",{parentName:"ul"},"MockSocket -- how it works, local testing "),(0,o.kt)("li",{parentName:"ul"},"Testing Plug connection ")),(0,o.kt)("h3",{id:"mocksocket"},"MockSocket"),(0,o.kt)("h3",{id:"testing-integration-locally"},"Testing integration locally"),(0,o.kt)("p",null,"MockSocket is a test tool that Plugs can use to test their integration with Socket. MockSocket simulates the functionality of Socket without actually sending a cross-chain message. It does this by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"inbound")," method on the Plug directly when an ",(0,o.kt)("inlineCode",{parentName:"p"},"outbound")," message transaction is initiated. "),(0,o.kt)("p",null,"Plugs can use MockSocket to test their SC integration with Socket. Find example tests that utilise MockSocket in ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/SocketDotTech/socketDL-examples/tree/main/test"},(0,o.kt)("inlineCode",{parentName:"a"},"SocketDL-examples")),". Plugs can assert the intended state changes on the destination chain and verify successful execution of the message."),(0,o.kt)("p",null,"MockSocket is not an E2E testing solution for message delivery on Plugs. It does not account for validity of message, gasPrice hikes on blockchains etc. For E2E testing, Plugs can be deployed on any ",(0,o.kt)("a",{parentName:"p",href:"/dev-resources/deployment-addresses"},"supported testnets"),"."),(0,o.kt)("h3",{id:"testing-plug-connection"},"Testing Plug connection"),(0,o.kt)("h4",{id:"api"},"API"),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"/dev-resources/APIReference/check-connection"},"Check Connection helper API")," can be used to verify a connection is successfully established between two Plugs."),(0,o.kt)("h4",{id:"on-chain"},"On-chain"),(0,o.kt)("p",null,"Once the connection step is complete, you can verify the connection was successful by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"getPlugConfig()")," method on Socket. This is a view function that returns the config of the plug for a given remote chain. If it returns the config, then the Plug connection is successful."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'/* \n    EXAMPLE TO RETURN GOERLI PLUG CONFIG FOR CONNECTION MUMBAI TESTNET\n    CHAIN 5\n\n    PLUG ADDRESS : 0x876B15bc0963C3c1AcA50Adfc0685A458449E41d\n    SIBLING CHAIN ID : 80001\n\n    This script returns the configuration of a Plug for a given sibling chain\n*/\n\nconst { Contract, providers } = require("ethers");\n\n// SOCKET CONFIG\nconst ABI = [\n    "function getPlugConfig(address plugAddress_, uint256 siblingChainSlug_) view returns (address siblingPlug, address inboundSwitchboard__, address outboundSwitchboard__, address capacitor__, address decapacitor__)"\n];\nconst RPC = "https://rpc.ankr.com/eth_goerli";\nconst CONTRACT_ADDRESS = "0xA78426325b5e32Affd5f4Bc8ab6575B24DCB1762";\n\n\n// PLUG CONFIG\nconst PLUG_ADDRESS = "0x876B15bc0963C3c1AcA50Adfc0685A458449E41d";\nconst SIBLING_CHAIN_SLUG = 80001;\n\nconst main = async () => {\n    const provider = new providers.JsonRpcProvider(RPC);\n    const contract = new Contract(CONTRACT_ADDRESS, ABI, provider);\n\n    const plugConfig = await contract.getPlugConfig(PLUG_ADDRESS, SIBLING_CHAIN_SLUG);\n\n    console.log(plugConfig);\n}\n\nmain();\n')))}p.isMDXComponent=!0}}]);